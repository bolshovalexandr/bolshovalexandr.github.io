'use strict';var formLogin=document.querySelector('#form-login'),formLoginBtn=formLogin.querySelector('BUTTON'),listLogin=document.querySelector('#list-login-list'),listLog=document.querySelector('#list-log-list'),listLogBody=document.querySelector('#log-body'),profile=document.querySelector('#profile'),profileName=profile.querySelector('#profile-name'),profileTime=profile.querySelector('#profile-time'),profileDirectory=profile.querySelector('#profile-directory'),profileExit=profile.querySelector('#profile-exit'),cleanStorage=function(){sessionStorage.removeItem('userNickname'),sessionStorage.removeItem('userLastLogin'),sessionStorage.removeItem('userToken')},setLocalStorage=function(a){sessionStorage.setItem('userNickname',a.nickname),sessionStorage.setItem('userLastLogin',a.lastLogin),sessionStorage.setItem('userDirectory',a.directory),sessionStorage.setItem('userToken',a.token)},hideFormShowProfile=function(){formLogin.classList.add('d-none'),profile.classList.remove('d-none')},hideProfileShowForm=function(){formLogin.classList.remove('d-none'),profile.classList.add('d-none')},getTocken=function(a){var b=new XMLHttpRequest;b.responseType='json',b.open('POST',formLogin.action,!0),b.send(a),b.addEventListener('load',function(){200===b.response.status?(formLoginBtn.classList.remove('btn-danger'),setLocalStorage(b.response.data),hideFormShowProfile(),profileName.innerHTML=sessionStorage.getItem('userNickname'),profileTime.innerHTML=sessionStorage.getItem('userLastLogin'),profileDirectory.innerHTML=sessionStorage.getItem('userDirectory')):formLoginBtn.classList.add('btn-danger')})},getLog=function(){var a=new XMLHttpRequest,b='position=0&count=50&token='+sessionStorage.getItem('userToken'),c='https://lopos.bidone.ru/api/v1/lopos_directory/'+sessionStorage.getItem('userDirectory')+'/update_log/'+Date.now()+'/story';a.open('POST',c,!0),a.responseType='json',a.send(b),a.addEventListener('load',function(){281===a.response.status&&(listLogBody.innerHTML='',a.response.data.forEach(function(d,e){listLogBody.innerHTML+='<div>'+e+' '+d.ha_comment+'</div>'}))})};formLogin.addEventListener('submit',function(a){a.preventDefault();var b=new FormData(formLogin);b.append('deviceToken','2222'),getTocken(b)}),listLogin.addEventListener('click',function(){sessionStorage.getItem('userNickname')?hideFormShowProfile():hideProfileShowForm()}),profileExit.addEventListener('click',function(){hideProfileShowForm(),formLogin.reset(),cleanStorage()}),listLog.addEventListener('click',function(){sessionStorage.getItem('userNickname')?getLog():listLogBody.innerHTML='\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0439\u0442\u0435\u0441\u044C...'});
